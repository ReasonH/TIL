## 도커란?

1. 컨테이너 기반 가상화 도구
2. 리눅스 상에서 컨테이너 방식으로 프로세스를 격리 실행하고 관리하도록 돕는다.
3. 계층화된 파일 시스템에 기반해 효율적으로 이미지를 구축하도록 해준다.

    **이미지 == 프로세스 실행 환경**

    - 이미지기반 컨테이너 실행
    - 컨테이너 상태를 변경해 이미지 생성
    - 이미지는 파일 보관 및 원격 저장소를 통한 공유가 가능하다.

## 왜 도커를 사용하는가?

[왜 도커를 사용하는가?](Why-Use-Docker.md)

### 도커 시작하기

도커는 가상머신과 같이 HW를 가상화하지 않는다. 리눅스 OS에서 지원하는 다양한 기능을 통해 컨테이너 실행을 위한 별도 환경을 준비하고, 프로세스를 격리시켜서 실행 시켜준다.

다음은 우분투에서 센트OS 환경을 구축하는 경우에 가상머신과 컨테이너의 차이를 보여준다.

```bash
가상 머신 실행
$ cat /etc/lsb-release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=18.04
DISTRIB_CODENAME=bionic
DISTRIB_DESCRIPTION="Ubuntu 18.04.3 LTS"
... 기타 많음

도커가 설치된 환경이라면?
$ docker run -it --rm centos:latest bash
```

### 도커 이미지

이미지 → 애플리케이션을 실행하기 위한 환경, 파일들의 집합이다.

도커는 애플리케이션 실행을 위한 파일들을 모으고 애플리케이션과 함께 이미지로 만들 수 있으며 이미지를 기반으로 애플리케이션을 바로 배포할 수 있다.

ex) centos 컨테이너에서 bash 셸 실행

1. 도커 레지스트리에서 centos 이미지를 풀 받는다.
2. 이를 통해 컨테이너를 실행한다.

```bash
$ docker pull centos
```

이미지 관련 정보는 [도커 허브](https://hub.docker.com/_/centos)에서 확인 가능하다.

도커 허브에는 공식 이미지와 사용자들의 이미지들이 등록되어 있다. 공식 이미지의 경우 자주 사용되는 애플리케이션에 한해 제공되며 네임스페이스가 없다. 반대로 유저 이미지는 username/imagename 형태로 네임스페이스가 존재한다.

### 도커 컨테이너

이미지 → 애플리케이션을 실행하기 위한 환경, 파일들의 집합

컨테이너 → 이미지의 환경 위에서 특정 프로세스를 격리시켜 실행한 것

docker run을 통해 컨테이너를 실행할 수 있다. 여기서는 셸을 실행하기 위해 -it 옵션을 추가한다. `docker run -it <이미지:태그> <명령어>`로 centos 이미지 기반 컨테이너를 실행시킨다.

```bash
$ docker run -it centos:latest bash
```

이는 명령어를 직접 넘겨 이미지를 컨테이너로 실행시킨 경우이지만, 보통의 이미지들은 명령어 기본값이 저장되어 있다.

**SSH vs Shell**

앞서 실행한 centos의 bash shell에서 exit명령어로 셸을 종료하면 컨테이너 또한 종료 된다.

도커로 셸을 직접 실행해 사용하는 것과 외부 서버에 SSH로 접속하는 것의 차이를 인지해야 도커 컨테이너와 가상 머신이 헷갈리지 않을 수 있다.

- 컨테이너는 **가상머신이 아닌 프로세스**라는 것을 기억하자

### 도커와 버전 관리

도커의 또다른 특징은 계층화된 파일 시스템을 사용한다는 점이다. 특정한 이미지로부터 생성된 컨테이너에 변경사항을 더하고 변경된 상태를 새로운 이미지로 만들어내는 것이 가능하다.

[실습-1, 도커 이미지 생명주기](practice/practice1.md)

[실습-2, Dockerfile로 이미지 생성](practice/practice2.md)

[실습-3, 도커 이미지로 서버 애플리케이션 배포](practice/practice3.md)

---

명령어 익히기

[02. 도커 컨테이너 배포](practice/cmd-practice2.md)

[03. 컨테이너 실전 구축 및 배포](practice/cmd-practice3.md)

### 향후 공부해야할 것들...
- 컨테이너 데이터 보존을 위한 데이터 볼륨 설정
- 다수의 인스턴스 생성과 트래픽 분산
- 컨테이너 오케스트레이션
---

참조
[블로그: 44bits](https://www.44bits.io/ko/post/easy-deploy-with-docker)
책: 도커/쿠버네티스를 활용한 컨테이너